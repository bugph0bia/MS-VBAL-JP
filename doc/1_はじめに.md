# 1 はじめに

この仕様は、Visual Basic for Applications (VBA) 言語を定義するもので、ホストアプリケーション内にマクロ言語として組み込まれることを目的とした、実装やオペレーティングシステムに依存しないプログラミング言語である。ここで規定する内容には、仕様に準拠するすべての実装に存在し、且つ同じように動作することが要求されたすべての言語機能と動作内容が含まれる。そういった機能には、準拠した実装に存在する組込み関数も含まれる。

## 1.1 用語の解説

本書では下記の用語を使用する。

**コードページ**  
ある特定の文書の文字を順に並べたもので、各文字に数値によるインデックス（コードポイント値）が割り当てられる。コードページは、各国で使用されている文字セットやキーボードレイアウトをサポートするための手段である。ディスプレイやキーボードなどのデバイスは、特定のコードページを使用するように設定することができ、ユーザーの要求に応じて、ある特定のコードページ（米国など）から別のコードページ（ポルトガルなど）に切り替えることができる。

**Unicode**  
ユニコードコンソーシアムが開発した、世界のほぼすべての文字を表現する文字エンコーディング規格。Unicode の標準規格 [（UNICODE5.0.0/2007）](https://go.microsoft.com/fwlink/?LinkId=154659) では、3 つの形式（UTF-8, UTF-16, UTF-32）と 7 つのスキーム（UTF-8, UTF-16, UTF-16 BE, UTF-16 LE, UTF-32, UTF-32 LE, UTF-32 BE）を提供している。

<ins>**～してもよい（MAY）**</ins>  
<ins>**～する必要がある（SHOULD）**</ins>  
<ins>**～しなければならない（MUST）**</ins>  
<ins>**～しないほうがよい（SHOULD NOT）**</ins>  
<ins>**～してはならない（MUST NOT）**</ins>  
これらの用語（訳注：英文ではすべて大文字で表現されているが、日本語訳では全て下線付きで表現する）は [RFC2119](https://go.microsoft.com/fwlink/?LinkId=90317) の定義どおりに使用される。オプションの動作に関するすべての記述は、「<ins>**してもよい**</ins>」「<ins>**する必要がある**</ins>」「<ins>**しないほうがよい**</ins>」のいずれかを使用する。

## 1.2 参考文献

Microsoft Open Specifications ライブラリ内のドキュメントへのリンクは、参照されたドキュメントの最新バージョンの正しいセクションを指すが、ライブラリ内の個々の文書は同時に更新されないため、文書内のセクション番号が一致しない場合がある。[正誤表](https://go.microsoft.com/fwlink/?linkid=850906)を確認することで正しいセクション番号を確認することができる。

### 1.2.1 規範となる参考文献
私たちは、規範となる参考文献を継続的に利用できるように頻繁に調査を行っている。規範となる参考文献を見つけるのに問題がある場合は、dochelp@microsoft.com まで連絡してもらえれば、関連情報を見つけるお手伝いをする。

- [IEEE754] IEEE, "IEEE Standard for Binary Floating-Point Arithmetic", IEEE 754-1985, October 1985, http://ieeexplore.ieee.org/servlet/opac?punumber=2355
- [MS-DTYP] Microsoft Corporation, "Windows Data Types".
- [MS-OAUT] Microsoft Corporation, "OLE Automation Protocol".
- [RFC2119] Bradner, S., "Key words for use in RFCs to Indicate Requirement Levels", BCP 14, RFC 2119, March 1997, http://www.rfc-editor.org/rfc/rfc2119.txt
- [RFC4234] Crocker, D., Ed., and Overell, P., "Augmented BNF for Syntax Specifications: ABNF", RFC 4234, October 2005, http://www.rfc-editor.org/rfc/rfc4234.txt

### 1.2.2 情報に関する参考文献
- [CODEPG] Microsoft Corporation, "Code Pages", https://learn.microsoft.com/globalization/encoding/code-pages
- [UNICODE-BESTFIT] The Unicode Consortium, "WindowsBestFit", 2006, http://www.unicode.org/Public/MAPPINGS/VENDORS/MICSFT/WindowsBestFit/
- [UNICODE-README] The Unicode Consortium, "Readme.txt", 2006, http://unicode.org/Public/MAPPINGS/VENDORS/MICSFT/WindowsBestFit/readme.txt

## 1.3 VBA 言語仕様の概要
VBA は、ワープロなどのホストアプリケーションと連携して使用することを目的としたコンピュータプログラミング言語である。この場合、エンドユーザーは VBA 言語を使用してホストアプリケーションのデータや機能にアクセスして制御するためのプログラムを記述することができる。

本書は、独立した実装の作成を可能にする実装に依存しない VBA 言語の仕様である。VBA 言語のソースコードに互換性のある実装を作成するために、すべての準拠する実装でサポートされるソース言語の必要な特性および動作を定義する。これにより、プログラマーが複数の実装で実行することを意図している場合において、プログラムが使用可能な非実装依存の特性と動作の正確な内容を定義することにより、移植可能な VBA プログラムを作成することが可能となる。

VBA 言語仕様のスコープは、実装にもオペレーティングシステムにも依存せず、準拠するすべての実装によってサポートされるコアプログラミング言語である。これには、すべての準拠する実装において存在して同じように動作するすべての機能および動作が含まれる。このような機能には、実装に存在する組み込み関数が含まれる。

本書は、VBA 言語の構文、静的セマンティクス、実行時セマンティクスを定義する。構文は、VBA 実装により認識される VBA ソースコード表現を定義する。静的セマンティクスは、非構文的なプログラム有効性要件を定義する。実行セマンティクスは、指定された構文と静的セマンティクスの規則に準拠する VBA プログラムの実行動作を定義する。実行時セマンティクスは、VBA プログラムが実行することの意味を記述するが、VBA 実装がこれをどのように達成するかは記述しない。

VBA 言語仕様は、VBA の実装が実際にどのように仕様の要件を達成するのかを定義しておらず、VBA 実装の具体的な設計も記述しない。

この仕様で定義される言語は、Microsoft Office 2010 スイートに含まれる Microsoft Visual Basic for Applications 7.0 （VBA 7.0）および Microsoft Office 2013 に含まれる VBA バージョン 7.1 によって実装される言語である。この仕様には、以前の Microsoft VBA バージョン用に作成された VBA プログラムのソースコードの下位互換性を提供する機能が含まれる。

## 1.4 仕様の規定

この言語の字句および構文は、[RFC4234](https://go.microsoft.com/fwlink/?LinkId=90462) で定義された ABNF を使用する文法によって記述される。この仕様の本文中では、ABNF 規則の名称は `<for-statement>` のように角括弧で囲んで区別される。

静的セマンティクスルールは、文法ルールを参照した散文的な記述、表、擬似コードアルゴリズムとして表現される。実行時セマンティクスは、実装に依存しない抽象的な計算概念を用いて、散文的に表現される。

本書では，本書の文脈の中で専門的な意味を持つ多数の用語が定義されている。本書内このような用語が使用される場合は、通常イタリック体で表示される。本書の各セクションで最初に使用される用語は、その用語を定義しているセクションを参照している。  
（訳注：全角文字でイタリック体は使用できないので反映しない。）

この仕様において、"実装定義" というフレーズは、言語機能の構文やセマンティクスの文脈上明らかな詳細が意図的に規定されずに残されており、言語の実装間で異なる可能性があることを意味している。しかし、指定されていない詳細の実装は繰り返し一貫<ins>している必要があり</ins>、言語機能の有用性を維持するために実装はその特定の動作を文書化<ins>する必要がある</ins>。

"実装固有" というフレーズは、言語機能の構文やセマンティクスの文脈上明らかな詳細が意図的に規定されずに残されており、言語の実装間で異なる可能性があることを意味している。しかし、指定されていない詳細の実装は繰り返し<ins>一貫している必要がある</ins>。

"未定義" というフレーズは、その言語の機能の構文やセマンティクスの文脈上明らかな詳細が意図的にされずに残され、言語の実装間で異なる可能性があることを意味している。また、動作の一貫性や再現可能性は要求も期待もされない。

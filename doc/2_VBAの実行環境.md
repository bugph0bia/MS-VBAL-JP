# 2 VBA の実行環境

VBA は、VBA 環境と呼ばれる特定の実行環境内で発生した処理を実行するプログラムを定義するためのプログラミング言語である。VBA 環境は通常、ホストアプリケーションと呼ばれる別のコンピュータアプリケーションによって制御される。ホストアプリケーションは、そのホストされた VBA 環境内の計算プロセスを制御して呼び出す。また、ホストアプリケーションは、VBA プログラムがホストアプリケーションのデータおよび計算プロセスにアクセスできるように、ホストされた VBA 環境内の計算リソースを利用可能にすることができる。このセクションの残りの部分では、VBA 環境の主要な計算コンセプトを定義する。

## 2.1 データの値と型

VBA 環境では情報は値として表現される。値はそのような要素の特定の有限領域の単一の要素である。VBA 環境ではさまざまな型を定義している。これらの型は、VBA の値の範囲を集合的に定義する。各値の型は、この仕様で定義される固有の特性を持つ。VBA 環境内の各値は、これらの型の 1 つのメンバである。個々の値は不変である。これは、VBA 環境内で値を別の値に変更するための仕組みが存在しないことを意味する。値は不変なので、特定の値の複数のコピーが VBA 環境内に存在することができ、そのようなコピーは論理的にすべて同じデータといえる。

The value types of the VBA Environment are defined by the following table. The nominal representation is the representation that was used as the original design basis for the VBA value types.

VBA 環境の値の種類は以下の表で定義される。基準表現とは、VBA の型の当初の設計基準として使用された表現である。

実装では、これらの特定の型表現を使用して、本仕様の要求事項を満たすことができる。

| 型名     | 値の範囲                                                                                     | 表現規格                                                                       |
| -------- | -------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------ |
| Boolean  | True, False                                                                                  | 16 ビット符号付き整数</br>2 の補数表現で 0 (False) または -1 (True) の値を取る |
| Byte     | 0 ～ 255 の整数値                                                                            | 8 ビット符号なし整数                                                           |
| Currency | 小数部を 4 桁持つ以下の範囲の数値</br>-922,337,203,685,477.5808 ～ +922,337,203,685,477.5807 | 64 ビット符号付き整数</br>暗黙的に 10 の -4 乗にスケールされる                 |
